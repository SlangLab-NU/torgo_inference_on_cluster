06-Mar-24 17:13:13 - Test Speaker: M03
06-Mar-24 17:13:13 - Log File Path: /output/logs/torgo_xlsr_finetune_M03/M03_train_20240306_171313.log

06-Mar-24 17:13:25 - Using GPU: Tesla T4

06-Mar-24 17:13:26 - Splitting the dataset into training / validation / test sets...
06-Mar-24 17:13:26 - Unique speakers found in the dataset:
06-Mar-24 17:13:26 - ['F01' 'F03' 'F04' 'FC01' 'FC02' 'FC03' 'M01' 'M02' 'M03' 'M04' 'M05'
 'MC01' 'MC02' 'MC03' 'MC04']

06-Mar-24 17:13:26 - After removal of repeated prompts, the number of data in each dataset is:
06-Mar-24 17:13:26 - Train:       9493/14519 (65%)
06-Mar-24 17:13:26 - Validation:  483/1075 (44%)
06-Mar-24 17:13:26 - Test:        442/800 (55%)

06-Mar-24 17:13:27 - Vocab Dictionary:
06-Mar-24 17:13:27 - {'[PAD]': 0, '<s>': 1, '</s>': 2, '[UNK]': 3, "'": 4, 'a': 5, 'b': 6, 'c': 7, 'd': 8, 'e': 9, 'f': 10, 'g': 11, 'h': 12, 'i': 13, 'j': 14, 'k': 15, 'l': 16, 'm': 17, 'n': 18, 'o': 19, 'p': 20, 'q': 21, 'r': 22, 's': 23, 't': 24, 'u': 25, 'v': 26, 'w': 27, 'x': 28, 'y': 29, 'z': 30, '|': 31}

06-Mar-24 17:14:40 - After filtering audio within a certain length, the number of data in each dataset is:
06-Mar-24 17:14:40 - Train:       9376/14519 (64%)
06-Mar-24 17:14:40 - Validation:  460/1075 (42%)
06-Mar-24 17:14:40 - Test:        442/800 (55%)

06-Mar-24 17:14:46 - Cloning https://huggingface.co/macarious/torgo_xlsr_finetune_M03 into local empty directory.
06-Mar-24 17:14:53 - Start Training
06-Mar-24 17:14:53 - Training Arguments:
06-Mar-24 17:14:53 - {'Training Epochs': 20, 'Training Batch Size': 4, 'Evaluation Batch Size': 4, 'Learning Rate': 0.0001, 'Weight Decay': 0.005}
06-Mar-24 17:14:53 - No checkpoint found in the repository. Training from scratch.
06-Mar-24 17:31:32 - Current Word Error Rate: 1.0
06-Mar-24 17:48:56 - Current Word Error Rate: 0.9813242784380306
06-Mar-24 17:58:09 - Several commits (2) will be pushed upstream.
06-Mar-24 18:05:33 - Current Word Error Rate: 0.6443123938879457
06-Mar-24 18:22:19 - Current Word Error Rate: 0.5415959252971138
06-Mar-24 18:23:31 - Several commits (2) will be pushed upstream.
06-Mar-24 18:39:07 - Current Word Error Rate: 0.42699490662139217
06-Mar-24 18:55:36 - Current Word Error Rate: 0.40407470288624786
06-Mar-24 19:04:48 - Several commits (2) will be pushed upstream.
06-Mar-24 19:12:11 - Current Word Error Rate: 0.3616298811544992
06-Mar-24 19:13:17 - Several commits (3) will be pushed upstream.
06-Mar-24 19:28:49 - Current Word Error Rate: 0.33446519524617996
06-Mar-24 19:29:57 - Several commits (2) will be pushed upstream.
06-Mar-24 19:45:24 - Current Word Error Rate: 0.3149405772495755
06-Mar-24 20:02:05 - Current Word Error Rate: 0.2894736842105263
06-Mar-24 20:18:35 - Current Word Error Rate: 0.28522920203735147
06-Mar-24 20:35:22 - Current Word Error Rate: 0.2733446519524618
06-Mar-24 20:52:01 - Current Word Error Rate: 0.3030560271646859
06-Mar-24 21:08:35 - Current Word Error Rate: 0.30220713073005095
06-Mar-24 21:09:43 - Several commits (2) will be pushed upstream.
06-Mar-24 21:25:13 - Current Word Error Rate: 0.2707979626485569
06-Mar-24 21:26:21 - Several commits (2) will be pushed upstream.
06-Mar-24 21:41:42 - Current Word Error Rate: 0.27249575551782684
06-Mar-24 21:58:15 - Current Word Error Rate: 0.25891341256366723
06-Mar-24 22:14:50 - Current Word Error Rate: 0.2546689303904924
06-Mar-24 22:31:15 - Current Word Error Rate: 0.23769100169779286
06-Mar-24 22:32:21 - Several commits (2) will be pushed upstream.
06-Mar-24 22:47:56 - Current Word Error Rate: 0.24533106960950765
06-Mar-24 22:57:05 - Several commits (2) will be pushed upstream.
06-Mar-24 23:04:29 - Current Word Error Rate: 0.23938879456706283
06-Mar-24 23:20:54 - Current Word Error Rate: 0.24787775891341257
06-Mar-24 23:21:58 - Several commits (2) will be pushed upstream.
06-Mar-24 23:37:25 - Current Word Error Rate: 0.2495755517826825
06-Mar-24 23:38:29 - Several commits (2) will be pushed upstream.
06-Mar-24 23:44:32 - Training completed in 6:29:39.360057

06-Mar-24 23:44:32 - Training Log Metrics:
06-Mar-24 23:44:32 - {'loss': 25.0933, 'learning_rate': 5e-05, 'epoch': 0.43, 'step': 500}
06-Mar-24 23:44:32 - {'loss': 3.6313, 'learning_rate': 0.0001, 'epoch': 0.85, 'step': 1000}
06-Mar-24 23:44:32 - {'eval_loss': 3.3954684734344482, 'eval_wer': 1.0, 'eval_runtime': 26.8672, 'eval_samples_per_second': 17.121, 'eval_steps_per_second': 4.28, 'epoch': 0.85, 'step': 1000}
06-Mar-24 23:44:32 - {'loss': 3.368, 'learning_rate': 9.777183600713012e-05, 'epoch': 1.28, 'step': 1500}
06-Mar-24 23:44:32 - {'loss': 2.8818, 'learning_rate': 9.554367201426026e-05, 'epoch': 1.71, 'step': 2000}
06-Mar-24 23:44:32 - {'eval_loss': 2.1112961769104004, 'eval_wer': 0.9813242784380306, 'eval_runtime': 26.6019, 'eval_samples_per_second': 17.292, 'eval_steps_per_second': 4.323, 'epoch': 1.71, 'step': 2000}
06-Mar-24 23:44:32 - {'loss': 1.4935, 'learning_rate': 9.331550802139037e-05, 'epoch': 2.13, 'step': 2500}
06-Mar-24 23:44:32 - {'loss': 1.0031, 'learning_rate': 9.10873440285205e-05, 'epoch': 2.56, 'step': 3000}
06-Mar-24 23:44:32 - {'eval_loss': 1.2799628973007202, 'eval_wer': 0.6443123938879457, 'eval_runtime': 26.8566, 'eval_samples_per_second': 17.128, 'eval_steps_per_second': 4.282, 'epoch': 2.56, 'step': 3000}
06-Mar-24 23:44:32 - {'loss': 0.8399, 'learning_rate': 8.885918003565062e-05, 'epoch': 2.99, 'step': 3500}
06-Mar-24 23:44:32 - {'loss': 0.6741, 'learning_rate': 8.663101604278076e-05, 'epoch': 3.41, 'step': 4000}
06-Mar-24 23:44:32 - {'eval_loss': 1.267611026763916, 'eval_wer': 0.5415959252971138, 'eval_runtime': 27.1439, 'eval_samples_per_second': 16.947, 'eval_steps_per_second': 4.237, 'epoch': 3.41, 'step': 4000}
06-Mar-24 23:44:32 - {'loss': 0.616, 'learning_rate': 8.440285204991087e-05, 'epoch': 3.84, 'step': 4500}
06-Mar-24 23:44:32 - {'loss': 0.5501, 'learning_rate': 8.2174688057041e-05, 'epoch': 4.27, 'step': 5000}
06-Mar-24 23:44:32 - {'eval_loss': 1.2920795679092407, 'eval_wer': 0.42699490662139217, 'eval_runtime': 26.7548, 'eval_samples_per_second': 17.193, 'eval_steps_per_second': 4.298, 'epoch': 4.27, 'step': 5000}
06-Mar-24 23:44:32 - {'loss': 0.494, 'learning_rate': 7.994652406417112e-05, 'epoch': 4.69, 'step': 5500}
06-Mar-24 23:44:32 - {'loss': 0.4451, 'learning_rate': 7.771836007130126e-05, 'epoch': 5.12, 'step': 6000}
06-Mar-24 23:44:32 - {'eval_loss': 1.2768977880477905, 'eval_wer': 0.40407470288624786, 'eval_runtime': 27.0201, 'eval_samples_per_second': 17.024, 'eval_steps_per_second': 4.256, 'epoch': 5.12, 'step': 6000}
06-Mar-24 23:44:32 - {'loss': 0.4248, 'learning_rate': 7.549019607843137e-05, 'epoch': 5.55, 'step': 6500}
06-Mar-24 23:44:32 - {'loss': 0.4099, 'learning_rate': 7.326203208556151e-05, 'epoch': 5.97, 'step': 7000}
06-Mar-24 23:44:32 - {'eval_loss': 1.223459243774414, 'eval_wer': 0.3616298811544992, 'eval_runtime': 26.7494, 'eval_samples_per_second': 17.197, 'eval_steps_per_second': 4.299, 'epoch': 5.97, 'step': 7000}
06-Mar-24 23:44:32 - {'loss': 0.3582, 'learning_rate': 7.103386809269163e-05, 'epoch': 6.4, 'step': 7500}
06-Mar-24 23:44:32 - {'loss': 0.3516, 'learning_rate': 6.880570409982176e-05, 'epoch': 6.83, 'step': 8000}
06-Mar-24 23:44:32 - {'eval_loss': 1.1445708274841309, 'eval_wer': 0.33446519524617996, 'eval_runtime': 26.8304, 'eval_samples_per_second': 17.145, 'eval_steps_per_second': 4.286, 'epoch': 6.83, 'step': 8000}
06-Mar-24 23:44:32 - {'loss': 0.3303, 'learning_rate': 6.657754010695188e-05, 'epoch': 7.25, 'step': 8500}
06-Mar-24 23:44:32 - {'loss': 0.3448, 'learning_rate': 6.434937611408201e-05, 'epoch': 7.68, 'step': 9000}
06-Mar-24 23:44:32 - {'eval_loss': 1.2614620923995972, 'eval_wer': 0.3149405772495755, 'eval_runtime': 26.8569, 'eval_samples_per_second': 17.128, 'eval_steps_per_second': 4.282, 'epoch': 7.68, 'step': 9000}
06-Mar-24 23:44:32 - {'loss': 0.3247, 'learning_rate': 6.212121212121213e-05, 'epoch': 8.11, 'step': 9500}
06-Mar-24 23:44:32 - {'loss': 0.2946, 'learning_rate': 5.9893048128342244e-05, 'epoch': 8.53, 'step': 10000}
06-Mar-24 23:44:32 - {'eval_loss': 1.1853114366531372, 'eval_wer': 0.2894736842105263, 'eval_runtime': 26.7195, 'eval_samples_per_second': 17.216, 'eval_steps_per_second': 4.304, 'epoch': 8.53, 'step': 10000}
06-Mar-24 23:44:32 - {'loss': 0.2639, 'learning_rate': 5.7664884135472376e-05, 'epoch': 8.96, 'step': 10500}
06-Mar-24 23:44:32 - {'loss': 0.2776, 'learning_rate': 5.5436720142602495e-05, 'epoch': 9.39, 'step': 11000}
06-Mar-24 23:44:32 - {'eval_loss': 1.2376693487167358, 'eval_wer': 0.28522920203735147, 'eval_runtime': 26.7579, 'eval_samples_per_second': 17.191, 'eval_steps_per_second': 4.298, 'epoch': 9.39, 'step': 11000}
06-Mar-24 23:44:32 - {'loss': 0.2412, 'learning_rate': 5.320855614973263e-05, 'epoch': 9.81, 'step': 11500}
06-Mar-24 23:44:32 - {'loss': 0.2446, 'learning_rate': 5.0980392156862745e-05, 'epoch': 10.24, 'step': 12000}
06-Mar-24 23:44:32 - {'eval_loss': 1.190428376197815, 'eval_wer': 0.2733446519524618, 'eval_runtime': 26.7069, 'eval_samples_per_second': 17.224, 'eval_steps_per_second': 4.306, 'epoch': 10.24, 'step': 12000}
06-Mar-24 23:44:32 - {'loss': 0.2504, 'learning_rate': 4.875222816399288e-05, 'epoch': 10.67, 'step': 12500}
06-Mar-24 23:44:32 - {'loss': 0.229, 'learning_rate': 4.6524064171123e-05, 'epoch': 11.09, 'step': 13000}
06-Mar-24 23:44:32 - {'eval_loss': 1.4909672737121582, 'eval_wer': 0.3030560271646859, 'eval_runtime': 26.3578, 'eval_samples_per_second': 17.452, 'eval_steps_per_second': 4.363, 'epoch': 11.09, 'step': 13000}
06-Mar-24 23:44:32 - {'loss': 0.2031, 'learning_rate': 4.429590017825312e-05, 'epoch': 11.52, 'step': 13500}
06-Mar-24 23:44:32 - {'loss': 0.2378, 'learning_rate': 4.2067736185383246e-05, 'epoch': 11.95, 'step': 14000}
06-Mar-24 23:44:32 - {'eval_loss': 1.22721529006958, 'eval_wer': 0.30220713073005095, 'eval_runtime': 26.4111, 'eval_samples_per_second': 17.417, 'eval_steps_per_second': 4.354, 'epoch': 11.95, 'step': 14000}
06-Mar-24 23:44:32 - {'loss': 0.2072, 'learning_rate': 3.983957219251337e-05, 'epoch': 12.37, 'step': 14500}
06-Mar-24 23:44:32 - {'loss': 0.1854, 'learning_rate': 3.7611408199643496e-05, 'epoch': 12.8, 'step': 15000}
06-Mar-24 23:44:32 - {'eval_loss': 1.2115793228149414, 'eval_wer': 0.2707979626485569, 'eval_runtime': 26.3346, 'eval_samples_per_second': 17.468, 'eval_steps_per_second': 4.367, 'epoch': 12.8, 'step': 15000}
06-Mar-24 23:44:32 - {'loss': 0.2207, 'learning_rate': 3.538324420677362e-05, 'epoch': 13.23, 'step': 15500}
06-Mar-24 23:44:32 - {'loss': 0.1829, 'learning_rate': 3.3155080213903747e-05, 'epoch': 13.65, 'step': 16000}
06-Mar-24 23:44:32 - {'eval_loss': 1.3385089635849, 'eval_wer': 0.27249575551782684, 'eval_runtime': 26.3537, 'eval_samples_per_second': 17.455, 'eval_steps_per_second': 4.364, 'epoch': 13.65, 'step': 16000}
06-Mar-24 23:44:32 - {'loss': 0.186, 'learning_rate': 3.092691622103387e-05, 'epoch': 14.08, 'step': 16500}
06-Mar-24 23:44:32 - {'loss': 0.1702, 'learning_rate': 2.8698752228163994e-05, 'epoch': 14.51, 'step': 17000}
06-Mar-24 23:44:32 - {'eval_loss': 1.3149060010910034, 'eval_wer': 0.25891341256366723, 'eval_runtime': 26.3493, 'eval_samples_per_second': 17.458, 'eval_steps_per_second': 4.364, 'epoch': 14.51, 'step': 17000}
06-Mar-24 23:44:32 - {'loss': 0.1907, 'learning_rate': 2.647058823529412e-05, 'epoch': 14.93, 'step': 17500}
06-Mar-24 23:44:32 - {'loss': 0.1706, 'learning_rate': 2.4242424242424244e-05, 'epoch': 15.36, 'step': 18000}
06-Mar-24 23:44:32 - {'eval_loss': 1.5505125522613525, 'eval_wer': 0.2546689303904924, 'eval_runtime': 26.422, 'eval_samples_per_second': 17.41, 'eval_steps_per_second': 4.352, 'epoch': 15.36, 'step': 18000}
06-Mar-24 23:44:32 - {'loss': 0.1519, 'learning_rate': 2.201426024955437e-05, 'epoch': 15.78, 'step': 18500}
06-Mar-24 23:44:32 - {'loss': 0.1694, 'learning_rate': 1.9786096256684494e-05, 'epoch': 16.21, 'step': 19000}
06-Mar-24 23:44:32 - {'eval_loss': 1.285996913909912, 'eval_wer': 0.23769100169779286, 'eval_runtime': 26.361, 'eval_samples_per_second': 17.45, 'eval_steps_per_second': 4.363, 'epoch': 16.21, 'step': 19000}
06-Mar-24 23:44:32 - {'loss': 0.1502, 'learning_rate': 1.7557932263814616e-05, 'epoch': 16.64, 'step': 19500}
06-Mar-24 23:44:32 - {'loss': 0.1528, 'learning_rate': 1.532976827094474e-05, 'epoch': 17.06, 'step': 20000}
06-Mar-24 23:44:32 - {'eval_loss': 1.2840015888214111, 'eval_wer': 0.24533106960950765, 'eval_runtime': 26.3627, 'eval_samples_per_second': 17.449, 'eval_steps_per_second': 4.362, 'epoch': 17.06, 'step': 20000}
06-Mar-24 23:44:32 - {'loss': 0.1474, 'learning_rate': 1.3101604278074866e-05, 'epoch': 17.49, 'step': 20500}
06-Mar-24 23:44:32 - {'loss': 0.1285, 'learning_rate': 1.0873440285204992e-05, 'epoch': 17.92, 'step': 21000}
06-Mar-24 23:44:32 - {'eval_loss': 1.293989658355713, 'eval_wer': 0.23938879456706283, 'eval_runtime': 26.4291, 'eval_samples_per_second': 17.405, 'eval_steps_per_second': 4.351, 'epoch': 17.92, 'step': 21000}
06-Mar-24 23:44:32 - {'loss': 0.1456, 'learning_rate': 8.645276292335117e-06, 'epoch': 18.34, 'step': 21500}
06-Mar-24 23:44:32 - {'loss': 0.1285, 'learning_rate': 6.417112299465242e-06, 'epoch': 18.77, 'step': 22000}
06-Mar-24 23:44:32 - {'eval_loss': 1.3790786266326904, 'eval_wer': 0.24787775891341257, 'eval_runtime': 26.4033, 'eval_samples_per_second': 17.422, 'eval_steps_per_second': 4.356, 'epoch': 18.77, 'step': 22000}
06-Mar-24 23:44:32 - {'loss': 0.1351, 'learning_rate': 4.188948306595366e-06, 'epoch': 19.2, 'step': 22500}
06-Mar-24 23:44:32 - {'loss': 0.1253, 'learning_rate': 1.96078431372549e-06, 'epoch': 19.62, 'step': 23000}
06-Mar-24 23:44:32 - {'eval_loss': 1.4153778553009033, 'eval_wer': 0.2495755517826825, 'eval_runtime': 26.3637, 'eval_samples_per_second': 17.448, 'eval_steps_per_second': 4.362, 'epoch': 19.62, 'step': 23000}
06-Mar-24 23:44:32 - {'train_runtime': 23261.5176, 'train_samples_per_second': 8.061, 'train_steps_per_second': 1.008, 'total_flos': 1.5830588184710908e+19, 'train_loss': 1.0442319886269422, 'epoch': 20.0, 'step': 23440}
06-Mar-24 23:44:32 - Pushing model to Hugging Face...
06-Mar-24 23:45:40 - Several commits (3) will be pushed upstream.
06-Mar-24 23:45:40 - The progress bars may be unreliable.
06-Mar-24 23:45:49 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03/': Received HTTP code 503 from proxy after CONNECT

06-Mar-24 23:45:50 - The push command with PID 75950 failed.
06-Mar-24 23:45:50 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03/': Received HTTP code 503 from proxy after CONNECT

06-Mar-24 23:45:50 - The push command with PID 78699 failed.
06-Mar-24 23:45:50 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03/': Received HTTP code 503 from proxy after CONNECT

06-Mar-24 23:45:50 - The push command with PID 255048 failed.
06-Mar-24 23:45:50 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03/': Received HTTP code 503 from proxy after CONNECT

06-Mar-24 23:45:50 - The push command with PID 255981 failed.
06-Mar-24 23:45:50 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03/': Received HTTP code 503 from proxy after CONNECT

06-Mar-24 23:45:50 - The push command with PID 257833 failed.
06-Mar-24 23:45:50 - EOF
EOF
error: failed to push some refs to 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03'

06-Mar-24 23:45:50 - The push command with PID 66252 failed.
06-Mar-24 23:45:50 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03/': Received HTTP code 503 from proxy after CONNECT

06-Mar-24 23:45:50 - The push command with PID 67972 failed.
06-Mar-24 23:45:50 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03/': Received HTTP code 503 from proxy after CONNECT

06-Mar-24 23:45:50 - The push command with PID 75326 failed.
06-Mar-24 23:45:50 - EOF
error: failed to push some refs to 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03'

06-Mar-24 23:45:50 - The push command with PID 78111 failed.
06-Mar-24 23:45:50 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03/': Received HTTP code 503 from proxy after CONNECT

06-Mar-24 23:45:50 - The push command with PID 111341 failed.
06-Mar-24 23:45:50 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03/': Received HTTP code 503 from proxy after CONNECT

06-Mar-24 23:45:50 - The push command with PID 113143 failed.
06-Mar-24 23:45:50 - EOF
error: failed to push some refs to 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03'

06-Mar-24 23:45:50 - The push command with PID 113981 failed.
06-Mar-24 23:45:50 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M03/': Received HTTP code 503 from proxy after CONNECT

