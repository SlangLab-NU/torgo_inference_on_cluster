06-Mar-24 10:14:39 - Test Speaker: M02
06-Mar-24 10:14:39 - Log File Path: /output/logs/torgo_xlsr_finetune_M02/M02_train_20240306_101439.log

06-Mar-24 10:14:40 - Using GPU: Tesla T4

06-Mar-24 10:14:40 - Splitting the dataset into training / validation / test sets...
06-Mar-24 10:14:40 - Unique speakers found in the dataset:
06-Mar-24 10:14:40 - ['F01' 'F03' 'F04' 'FC01' 'FC02' 'FC03' 'M01' 'M02' 'M03' 'M04' 'M05'
 'MC01' 'MC02' 'MC03' 'MC04']

06-Mar-24 10:14:40 - After removal of repeated prompts, the number of data in each dataset is:
06-Mar-24 10:14:40 - Train:       9508/14553 (65%)
06-Mar-24 10:14:40 - Validation:  483/1075 (44%)
06-Mar-24 10:14:40 - Test:        423/766 (55%)

06-Mar-24 10:14:41 - Vocab Dictionary:
06-Mar-24 10:14:41 - {'[PAD]': 0, '<s>': 1, '</s>': 2, '[UNK]': 3, "'": 4, 'a': 5, 'b': 6, 'c': 7, 'd': 8, 'e': 9, 'f': 10, 'g': 11, 'h': 12, 'i': 13, 'j': 14, 'k': 15, 'l': 16, 'm': 17, 'n': 18, 'o': 19, 'p': 20, 'q': 21, 'r': 22, 's': 23, 't': 24, 'u': 25, 'v': 26, 'w': 27, 'x': 28, 'y': 29, 'z': 30, '|': 31}

06-Mar-24 10:15:21 - After filtering audio within a certain length, the number of data in each dataset is:
06-Mar-24 10:15:21 - Train:       9402/14553 (64%)
06-Mar-24 10:15:21 - Validation:  460/1075 (42%)
06-Mar-24 10:15:21 - Test:        403/766 (52%)

06-Mar-24 10:15:27 - Cloning https://huggingface.co/macarious/torgo_xlsr_finetune_M02 into local empty directory.
06-Mar-24 10:15:34 - Start Training
06-Mar-24 10:15:34 - Training Arguments:
06-Mar-24 10:15:34 - {'Training Epochs': 20, 'Training Batch Size': 4, 'Evaluation Batch Size': 4, 'Learning Rate': 0.0001, 'Weight Decay': 0.005}
06-Mar-24 10:15:34 - No checkpoint found in the repository. Training from scratch.
06-Mar-24 10:32:36 - Current Word Error Rate: 1.0
06-Mar-24 10:50:00 - Current Word Error Rate: 0.7538200339558574
06-Mar-24 11:06:58 - Current Word Error Rate: 0.5772495755517827
06-Mar-24 11:24:08 - Current Word Error Rate: 0.4567062818336163
06-Mar-24 11:41:08 - Current Word Error Rate: 0.3904923599320883
06-Mar-24 11:58:25 - Current Word Error Rate: 0.3938879456706282
06-Mar-24 12:15:32 - Current Word Error Rate: 0.3404074702886248
06-Mar-24 12:32:37 - Current Word Error Rate: 0.35059422750424446
06-Mar-24 12:49:56 - Current Word Error Rate: 0.31918505942275044
06-Mar-24 13:06:56 - Current Word Error Rate: 0.3200339558573854
06-Mar-24 13:24:15 - Current Word Error Rate: 0.3157894736842105
06-Mar-24 13:34:17 - Several commits (2) will be pushed upstream.
06-Mar-24 13:41:45 - Current Word Error Rate: 0.29796264855687604
06-Mar-24 13:43:20 - Several commits (3) will be pushed upstream.
06-Mar-24 13:59:11 - Current Word Error Rate: 0.2911714770797963
06-Mar-24 14:00:28 - Several commits (2) will be pushed upstream.
06-Mar-24 14:16:21 - Current Word Error Rate: 0.27419354838709675
06-Mar-24 14:25:45 - Several commits (2) will be pushed upstream.
06-Mar-24 14:33:10 - Current Word Error Rate: 0.2911714770797963
06-Mar-24 14:50:17 - Current Word Error Rate: 0.2869269949066214
06-Mar-24 15:07:03 - Current Word Error Rate: 0.27249575551782684
06-Mar-24 15:16:23 - Several commits (2) will be pushed upstream.
06-Mar-24 15:23:57 - Current Word Error Rate: 0.2758913412563667
06-Mar-24 15:41:00 - Current Word Error Rate: 0.26570458404074704
06-Mar-24 15:57:59 - Current Word Error Rate: 0.23769100169779286
06-Mar-24 16:14:55 - Current Word Error Rate: 0.2470288624787776
06-Mar-24 16:31:42 - Current Word Error Rate: 0.23684210526315788
06-Mar-24 16:48:54 - Current Word Error Rate: 0.23938879456706283
06-Mar-24 16:58:13 - Training completed in 6:42:39.524506

06-Mar-24 16:58:13 - Training Log Metrics:
06-Mar-24 16:58:13 - {'loss': 24.4191, 'learning_rate': 5e-05, 'epoch': 0.43, 'step': 500}
06-Mar-24 16:58:13 - {'loss': 3.5091, 'learning_rate': 0.0001, 'epoch': 0.85, 'step': 1000}
06-Mar-24 16:58:13 - {'eval_loss': 3.282400369644165, 'eval_wer': 1.0, 'eval_runtime': 27.3247, 'eval_samples_per_second': 16.835, 'eval_steps_per_second': 4.209, 'epoch': 0.85, 'step': 1000}
06-Mar-24 16:58:13 - {'loss': 3.1209, 'learning_rate': 9.777777777777778e-05, 'epoch': 1.28, 'step': 1500}
06-Mar-24 16:58:13 - {'loss': 1.6986, 'learning_rate': 9.555555555555557e-05, 'epoch': 1.7, 'step': 2000}
06-Mar-24 16:58:13 - {'eval_loss': 1.6781831979751587, 'eval_wer': 0.7538200339558574, 'eval_runtime': 27.398, 'eval_samples_per_second': 16.79, 'eval_steps_per_second': 4.197, 'epoch': 1.7, 'step': 2000}
06-Mar-24 16:58:13 - {'loss': 1.0788, 'learning_rate': 9.333333333333334e-05, 'epoch': 2.13, 'step': 2500}
06-Mar-24 16:58:13 - {'loss': 0.8367, 'learning_rate': 9.111111111111112e-05, 'epoch': 2.55, 'step': 3000}
06-Mar-24 16:58:13 - {'eval_loss': 1.1373724937438965, 'eval_wer': 0.5772495755517827, 'eval_runtime': 27.4375, 'eval_samples_per_second': 16.765, 'eval_steps_per_second': 4.191, 'epoch': 2.55, 'step': 3000}
06-Mar-24 16:58:13 - {'loss': 0.7247, 'learning_rate': 8.888888888888889e-05, 'epoch': 2.98, 'step': 3500}
06-Mar-24 16:58:13 - {'loss': 0.5881, 'learning_rate': 8.666666666666667e-05, 'epoch': 3.4, 'step': 4000}
06-Mar-24 16:58:13 - {'eval_loss': 1.254804253578186, 'eval_wer': 0.4567062818336163, 'eval_runtime': 27.3392, 'eval_samples_per_second': 16.826, 'eval_steps_per_second': 4.206, 'epoch': 3.4, 'step': 4000}
06-Mar-24 16:58:13 - {'loss': 0.5426, 'learning_rate': 8.444444444444444e-05, 'epoch': 3.83, 'step': 4500}
06-Mar-24 16:58:13 - {'loss': 0.5024, 'learning_rate': 8.222222222222222e-05, 'epoch': 4.26, 'step': 5000}
06-Mar-24 16:58:13 - {'eval_loss': 1.1945613622665405, 'eval_wer': 0.3904923599320883, 'eval_runtime': 27.3115, 'eval_samples_per_second': 16.843, 'eval_steps_per_second': 4.211, 'epoch': 4.26, 'step': 5000}
06-Mar-24 16:58:13 - {'loss': 0.4454, 'learning_rate': 8e-05, 'epoch': 4.68, 'step': 5500}
06-Mar-24 16:58:13 - {'loss': 0.4208, 'learning_rate': 7.777777777777778e-05, 'epoch': 5.11, 'step': 6000}
06-Mar-24 16:58:13 - {'eval_loss': 1.3829683065414429, 'eval_wer': 0.3938879456706282, 'eval_runtime': 27.213, 'eval_samples_per_second': 16.904, 'eval_steps_per_second': 4.226, 'epoch': 5.11, 'step': 6000}
06-Mar-24 16:58:13 - {'loss': 0.4177, 'learning_rate': 7.555555555555556e-05, 'epoch': 5.53, 'step': 6500}
06-Mar-24 16:58:13 - {'loss': 0.3647, 'learning_rate': 7.333333333333333e-05, 'epoch': 5.96, 'step': 7000}
06-Mar-24 16:58:13 - {'eval_loss': 1.2722117900848389, 'eval_wer': 0.3404074702886248, 'eval_runtime': 27.6701, 'eval_samples_per_second': 16.624, 'eval_steps_per_second': 4.156, 'epoch': 5.96, 'step': 7000}
06-Mar-24 16:58:13 - {'loss': 0.3599, 'learning_rate': 7.111111111111112e-05, 'epoch': 6.38, 'step': 7500}
06-Mar-24 16:58:13 - {'loss': 0.3357, 'learning_rate': 6.88888888888889e-05, 'epoch': 6.81, 'step': 8000}
06-Mar-24 16:58:13 - {'eval_loss': 1.1639457941055298, 'eval_wer': 0.35059422750424446, 'eval_runtime': 27.6976, 'eval_samples_per_second': 16.608, 'eval_steps_per_second': 4.152, 'epoch': 6.81, 'step': 8000}
06-Mar-24 16:58:13 - {'loss': 0.3037, 'learning_rate': 6.666666666666667e-05, 'epoch': 7.23, 'step': 8500}
06-Mar-24 16:58:13 - {'loss': 0.2972, 'learning_rate': 6.444444444444446e-05, 'epoch': 7.66, 'step': 9000}
06-Mar-24 16:58:13 - {'eval_loss': 1.377475380897522, 'eval_wer': 0.31918505942275044, 'eval_runtime': 27.7992, 'eval_samples_per_second': 16.547, 'eval_steps_per_second': 4.137, 'epoch': 7.66, 'step': 9000}
06-Mar-24 16:58:13 - {'loss': 0.278, 'learning_rate': 6.222222222222222e-05, 'epoch': 8.09, 'step': 9500}
06-Mar-24 16:58:13 - {'loss': 0.27, 'learning_rate': 6e-05, 'epoch': 8.51, 'step': 10000}
06-Mar-24 16:58:13 - {'eval_loss': 1.234513759613037, 'eval_wer': 0.3200339558573854, 'eval_runtime': 27.8435, 'eval_samples_per_second': 16.521, 'eval_steps_per_second': 4.13, 'epoch': 8.51, 'step': 10000}
06-Mar-24 16:58:13 - {'loss': 0.2727, 'learning_rate': 5.7777777777777776e-05, 'epoch': 8.94, 'step': 10500}
06-Mar-24 16:58:13 - {'loss': 0.2532, 'learning_rate': 5.555555555555556e-05, 'epoch': 9.36, 'step': 11000}
06-Mar-24 16:58:13 - {'eval_loss': 1.1760445833206177, 'eval_wer': 0.3157894736842105, 'eval_runtime': 27.7306, 'eval_samples_per_second': 16.588, 'eval_steps_per_second': 4.147, 'epoch': 9.36, 'step': 11000}
06-Mar-24 16:58:13 - {'loss': 0.2606, 'learning_rate': 5.333333333333333e-05, 'epoch': 9.79, 'step': 11500}
06-Mar-24 16:58:13 - {'loss': 0.2171, 'learning_rate': 5.111111111111111e-05, 'epoch': 10.21, 'step': 12000}
06-Mar-24 16:58:13 - {'eval_loss': 1.331000804901123, 'eval_wer': 0.29796264855687604, 'eval_runtime': 27.3137, 'eval_samples_per_second': 16.841, 'eval_steps_per_second': 4.21, 'epoch': 10.21, 'step': 12000}
06-Mar-24 16:58:13 - {'loss': 0.2451, 'learning_rate': 4.888888888888889e-05, 'epoch': 10.64, 'step': 12500}
06-Mar-24 16:58:13 - {'loss': 0.2367, 'learning_rate': 4.666666666666667e-05, 'epoch': 11.06, 'step': 13000}
06-Mar-24 16:58:13 - {'eval_loss': 1.26341712474823, 'eval_wer': 0.2911714770797963, 'eval_runtime': 27.3016, 'eval_samples_per_second': 16.849, 'eval_steps_per_second': 4.212, 'epoch': 11.06, 'step': 13000}
06-Mar-24 16:58:13 - {'loss': 0.2302, 'learning_rate': 4.4444444444444447e-05, 'epoch': 11.49, 'step': 13500}
06-Mar-24 16:58:13 - {'loss': 0.2086, 'learning_rate': 4.222222222222222e-05, 'epoch': 11.91, 'step': 14000}
06-Mar-24 16:58:13 - {'eval_loss': 1.3451378345489502, 'eval_wer': 0.27419354838709675, 'eval_runtime': 27.5632, 'eval_samples_per_second': 16.689, 'eval_steps_per_second': 4.172, 'epoch': 11.91, 'step': 14000}
06-Mar-24 16:58:13 - {'loss': 0.2054, 'learning_rate': 4e-05, 'epoch': 12.34, 'step': 14500}
06-Mar-24 16:58:13 - {'loss': 0.2023, 'learning_rate': 3.777777777777778e-05, 'epoch': 12.77, 'step': 15000}
06-Mar-24 16:58:13 - {'eval_loss': 1.4799491167068481, 'eval_wer': 0.2911714770797963, 'eval_runtime': 27.1913, 'eval_samples_per_second': 16.917, 'eval_steps_per_second': 4.229, 'epoch': 12.77, 'step': 15000}
06-Mar-24 16:58:13 - {'loss': 0.1874, 'learning_rate': 3.555555555555556e-05, 'epoch': 13.19, 'step': 15500}
06-Mar-24 16:58:13 - {'loss': 0.1862, 'learning_rate': 3.3333333333333335e-05, 'epoch': 13.62, 'step': 16000}
06-Mar-24 16:58:13 - {'eval_loss': 1.7212214469909668, 'eval_wer': 0.2869269949066214, 'eval_runtime': 27.3379, 'eval_samples_per_second': 16.826, 'eval_steps_per_second': 4.207, 'epoch': 13.62, 'step': 16000}
06-Mar-24 16:58:13 - {'loss': 0.1991, 'learning_rate': 3.111111111111111e-05, 'epoch': 14.04, 'step': 16500}
06-Mar-24 16:58:13 - {'loss': 0.1698, 'learning_rate': 2.8888888888888888e-05, 'epoch': 14.47, 'step': 17000}
06-Mar-24 16:58:13 - {'eval_loss': 1.4303908348083496, 'eval_wer': 0.27249575551782684, 'eval_runtime': 27.2537, 'eval_samples_per_second': 16.878, 'eval_steps_per_second': 4.22, 'epoch': 14.47, 'step': 17000}
06-Mar-24 16:58:13 - {'loss': 0.1725, 'learning_rate': 2.6666666666666667e-05, 'epoch': 14.89, 'step': 17500}
06-Mar-24 16:58:13 - {'loss': 0.1489, 'learning_rate': 2.4444444444444445e-05, 'epoch': 15.32, 'step': 18000}
06-Mar-24 16:58:13 - {'eval_loss': 1.623343825340271, 'eval_wer': 0.2758913412563667, 'eval_runtime': 27.1194, 'eval_samples_per_second': 16.962, 'eval_steps_per_second': 4.241, 'epoch': 15.32, 'step': 18000}
06-Mar-24 16:58:13 - {'loss': 0.1552, 'learning_rate': 2.2222222222222223e-05, 'epoch': 15.74, 'step': 18500}
06-Mar-24 16:58:13 - {'loss': 0.1489, 'learning_rate': 2e-05, 'epoch': 16.17, 'step': 19000}
06-Mar-24 16:58:13 - {'eval_loss': 1.631954550743103, 'eval_wer': 0.26570458404074704, 'eval_runtime': 27.2512, 'eval_samples_per_second': 16.88, 'eval_steps_per_second': 4.22, 'epoch': 16.17, 'step': 19000}
06-Mar-24 16:58:13 - {'loss': 0.1444, 'learning_rate': 1.777777777777778e-05, 'epoch': 16.6, 'step': 19500}
06-Mar-24 16:58:13 - {'loss': 0.1552, 'learning_rate': 1.5555555555555555e-05, 'epoch': 17.02, 'step': 20000}
06-Mar-24 16:58:13 - {'eval_loss': 1.366666316986084, 'eval_wer': 0.23769100169779286, 'eval_runtime': 27.2284, 'eval_samples_per_second': 16.894, 'eval_steps_per_second': 4.224, 'epoch': 17.02, 'step': 20000}
06-Mar-24 16:58:13 - {'loss': 0.139, 'learning_rate': 1.3333333333333333e-05, 'epoch': 17.45, 'step': 20500}
06-Mar-24 16:58:13 - {'loss': 0.1414, 'learning_rate': 1.1111111111111112e-05, 'epoch': 17.87, 'step': 21000}
06-Mar-24 16:58:13 - {'eval_loss': 1.519918441772461, 'eval_wer': 0.2470288624787776, 'eval_runtime': 27.2357, 'eval_samples_per_second': 16.89, 'eval_steps_per_second': 4.222, 'epoch': 17.87, 'step': 21000}
06-Mar-24 16:58:13 - {'loss': 0.1427, 'learning_rate': 8.88888888888889e-06, 'epoch': 18.3, 'step': 21500}
06-Mar-24 16:58:13 - {'loss': 0.1195, 'learning_rate': 6.666666666666667e-06, 'epoch': 18.72, 'step': 22000}
06-Mar-24 16:58:13 - {'eval_loss': 1.4951012134552002, 'eval_wer': 0.23684210526315788, 'eval_runtime': 27.2532, 'eval_samples_per_second': 16.879, 'eval_steps_per_second': 4.22, 'epoch': 18.72, 'step': 22000}
06-Mar-24 16:58:13 - {'loss': 0.1289, 'learning_rate': 4.444444444444445e-06, 'epoch': 19.15, 'step': 22500}
06-Mar-24 16:58:13 - {'loss': 0.1303, 'learning_rate': 2.2222222222222225e-06, 'epoch': 19.57, 'step': 23000}
06-Mar-24 16:58:13 - {'eval_loss': 1.45256769657135, 'eval_wer': 0.23938879456706283, 'eval_runtime': 27.2138, 'eval_samples_per_second': 16.903, 'eval_steps_per_second': 4.226, 'epoch': 19.57, 'step': 23000}
06-Mar-24 16:58:13 - {'loss': 0.1441, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 23500}
06-Mar-24 16:58:13 - {'train_runtime': 24028.7199, 'train_samples_per_second': 7.826, 'train_steps_per_second': 0.978, 'total_flos': 1.5816711672720589e+19, 'train_loss': 0.9672229300965655, 'epoch': 20.0, 'step': 23500}
06-Mar-24 16:58:13 - Pushing model to Hugging Face...
06-Mar-24 16:58:31 - Several commits (2) will be pushed upstream.
06-Mar-24 16:58:31 - The progress bars may be unreliable.
06-Mar-24 16:59:02 - To https://huggingface.co/macarious/torgo_xlsr_finetune_M02
   36fb5b7..1d80732  main -> main

06-Mar-24 16:59:08 - To https://huggingface.co/macarious/torgo_xlsr_finetune_M02
   1d80732..e72c43d  main -> main

06-Mar-24 16:59:10 - End of Script
06-Mar-24 16:59:10 - --------------------------------------------

06-Mar-24 16:59:10 - The push command with PID 241128 failed.
06-Mar-24 16:59:10 - EOF
error: failed to push some refs to 'https://huggingface.co/macarious/torgo_xlsr_finetune_M02'

06-Mar-24 16:59:10 - The push command with PID 242282 failed.
06-Mar-24 16:59:10 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M02/': Received HTTP code 503 from proxy after CONNECT

06-Mar-24 16:59:10 - The push command with PID 244539 failed.
06-Mar-24 16:59:10 - EOF
error: failed to push some refs to 'https://huggingface.co/macarious/torgo_xlsr_finetune_M02'

06-Mar-24 16:59:10 - The push command with PID 248234 failed.
06-Mar-24 16:59:10 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M02/': Received HTTP code 503 from proxy after CONNECT

06-Mar-24 16:59:10 - The push command with PID 11948 failed.
06-Mar-24 16:59:10 - fatal: unable to access 'https://huggingface.co/macarious/torgo_xlsr_finetune_M02/': Received HTTP code 503 from proxy after CONNECT

